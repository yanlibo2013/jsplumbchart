{"remainingRequest":"C:\\Users\\Administrator\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\package\\jsplumbchart\\src\\jsplumbchart\\index.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"C:\\work\\package\\jsplumbchart\\src\\jsplumbchart\\index.vue","mtime":1566720143288},{"path":"C:\\Users\\Administrator\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\work\\package\\jsplumbchart\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.jsplumb-chart {\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n  .cavans {\r\n    width: 100%;\r\n    height: 100%;\r\n    position: relative;\r\n    top: 0;\r\n    left: 0;\r\n    //   background-image: url(\"../assets/img/designBg.png\");\r\n\r\n    // ////////////////////////node style begin///////////////////\r\n    .designIconBig {\r\n      height: 70px;\r\n      width: 150px;\r\n      margin: 0 auto;\r\n      padding: 12px;\r\n      box-sizing: border-box;\r\n      box-shadow: 0 10px 18px -9px rgba(0, 0, 0, 0.5);\r\n      background: #ffffff;\r\n      text-align: center;\r\n      position: absolute;\r\n      margin-right: 15px;\r\n      margin-bottom: 20px;\r\n      cursor: pointer;\r\n      float: left;\r\n    }\r\n\r\n    .designIconBig i {\r\n      float: none !important;\r\n      position: absolute;\r\n      left: 5px;\r\n      top: 8px;\r\n      width: 30px !important;\r\n      height: 30px !important;\r\n      line-height: 30px !important;\r\n      font-size: 30px !important;\r\n    }\r\n\r\n    .designIconBig h4 {\r\n      position: absolute;\r\n      top: 5px;\r\n      left: 38px;\r\n      margin: 0px;\r\n      padding: 0px;\r\n      width: 110px;\r\n      text-align: left;\r\n      font-size: 14px;\r\n      font-weight: bold;\r\n      white-space: nowrap;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n\r\n    .designIconBig h5 {\r\n      position: absolute;\r\n      top: 25px;\r\n      left: 38px;\r\n      margin: 0px;\r\n      padding: 0px;\r\n      width: 110px;\r\n      text-align: left;\r\n      font-size: 12px;\r\n      font-weight: normal;\r\n      white-space: nowrap;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n\r\n    .designIconBig #removeDes {\r\n      position: absolute;\r\n      top: 46px;\r\n      right: 15px;\r\n      font-size: 14px;\r\n      color: #b9c0d8;\r\n      margin: 0px;\r\n      padding: 0px;\r\n    }\r\n\r\n    .designIconBig #copeDes {\r\n      position: absolute;\r\n      top: 45px;\r\n      right: 35px;\r\n      font-size: 14px;\r\n      color: #b9c0d8;\r\n      margin: 0px;\r\n      padding: 0px;\r\n    }\r\n    .designIconBig #pitchOnDes {\r\n      position: absolute;\r\n      top: 47px;\r\n      right: 60px;\r\n      font-size: 14px;\r\n      color: #b9c0d8;\r\n      margin: 0px;\r\n      padding: 0px;\r\n    }\r\n    .desingIconBig #markDes {\r\n      position: absolute;\r\n      top: 45px;\r\n      right: 20px;\r\n      font-size: 14px;\r\n      color: #b9c0d8;\r\n      margin: 0px;\r\n      padding: 0px;\r\n    }\r\n\r\n    .t1Style {\r\n      border: 2px solid #48c038;\r\n      color: #48c038;\r\n      border-radius: 2px;\r\n    }\r\n    .t2Style {\r\n      border: 2px solid #4586f3;\r\n      color: #4586f3;\r\n      border-radius: 2px;\r\n    }\r\n    .t3Style {\r\n      border: 2px solid #8367df;\r\n      color: #8367df;\r\n      border-radius: 2px;\r\n    }\r\n\r\n    .redStyle {\r\n      border: 2px solid red;\r\n    }\r\n    .designIconBg {\r\n      position: absolute;\r\n      color: #ffffff !important;\r\n    }\r\n\r\n    .designIconBig #removeDes:hover {\r\n      color: #ff4e4e;\r\n    }\r\n\r\n    .designIconBig #copeDes:hover {\r\n      color: #ff4e4e;\r\n    }\r\n\r\n    .designIconBig #pitchOnDes:hover {\r\n      color: #ff4e4e;\r\n    }\r\n\r\n    // ////////////////////////node style end///////////////////\r\n  }\r\n}\r\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwQA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/jsplumbchart","sourcesContent":["<template>\r\n  <div class=\"jsplumb-chart\">\r\n    <div class=\"cavans\" id=\"cavans\">\r\n      <div\r\n        v-for=\"(data,index) in stepData\"\r\n        :id=\"data.id\"\r\n        :key=\"index\"\r\n        :class=\"'designIconBig stepsItem '+setClass(nodeClass(data.type))\"\r\n        :data-sign=\"data.name\"\r\n        :data-type=\"data.type\"\r\n        :style=\"'left:'+data.x+'px;top:'+data.y+'px;position:absolute;margin:0'\"\r\n        @dblclick=\"dblClick(data)\"\r\n      >\r\n        <i class=\"icon iconfont icon-ir-designIconBg designIconBg\"></i>\r\n        <i\r\n          id=\"changeSte\"\r\n          :class=\"nodeIcon(data.type) == 'iconTrue'?'icon iconfont icon-ir-d-'+data.type:'icon iconfont icon-ir-d-default'\"\r\n        ></i>\r\n        <h4 :title=\"data.name\">{{data.name}}</h4>\r\n        <h5>ID:{{data.id}}</h5>\r\n        <!-- <em id=\"pitchOnDes\" class=\"fa fa-square-o\" title=\"选中\"></em> -->\r\n        <!-- <em id=\"copeDes\" class=\"icon iconfont icon-ir-copy\" title=\"复制\"></em> -->\r\n        <em id=\"removeDes\" class=\"fa fa-trash-o\" title=\"删除\" @click=\"delNode(data.id)\"></em>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n/* eslint-disable */\r\nimport { mapGetters, mapActions, mapState } from \"vuex\";\r\nimport getInstance from \"../utils/getInstance\";\r\nimport _ from \"lodash\";\r\nimport {\r\n  message,\r\n  filterLinkData,\r\n  nodeClass,\r\n  nodeIcon,\r\n  specialNodeClass,\r\n  origin,\r\n  destination,\r\n  addEndpointToNode,\r\n  getNodeType,\r\n  setClass,\r\n  connect\r\n} from \"..//utils/flowchart\";\r\nimport panzoom from \"panzoom\";\r\nexport default {\r\n  watch: {\r\n    data(val) {\r\n      this.stepData = this.data.stepData;\r\n      this.links = this.data.links;\r\n    },\r\n    stepData(val) {\r\n      this.$emit(\"modifyChart\", { stepData: val, links: this.links });\r\n    },\r\n    links(val) {\r\n      this.$emit(\"modifyChart\", { stepData: this.stepData, links: val });\r\n    }\r\n  },\r\n  props: {\r\n    data: {\r\n      type: Object,\r\n      default: false\r\n    }\r\n  },\r\n  components: {},\r\n  data: function() {\r\n    return {\r\n      jsplumbInstance: getInstance({\r\n        container: \"workplace\",\r\n        delConnections: this.delConnections,\r\n        completedConnect: this.completedConnect\r\n      }),\r\n      stepData: [],\r\n      links: [],\r\n      nodeClass: nodeClass,\r\n      nodeIcon: nodeIcon,\r\n      setClass: setClass\r\n    };\r\n  },\r\n  computed: {\r\n    //...mapState([\"\"])\r\n  },\r\n  mounted() {\r\n    this.$nextTick(() => {\r\n      //this.setZoomJsplumbChart();\r\n    });\r\n  },\r\n  beforeCreate() {},\r\n  created() {},\r\n  beforeMount() {},\r\n  beforeUpdate() {},\r\n  updated() {\r\n    this.$nextTick(() => {\r\n      this.drawJsplumbChart(\r\n        {\r\n          jsplumbInstance: this.jsplumbInstance,\r\n          self: this,\r\n          flowData: this.stepData,\r\n          links: this.links\r\n        },\r\n        () => {\r\n          this.getLinksData();\r\n        }\r\n      );\r\n    });\r\n  },\r\n  beforeDestroy() {},\r\n  destroyed: function() {},\r\n  methods: {\r\n    //...mapActions([\"\"]),\r\n    setZoomJsplumbChart() {\r\n      // 假设矩阵是：matrix(a,b,c,d,e,f);\r\n      // 如果只是平移translate，只关注最后两个数值就好：\r\n      // e是水平移动距离，f是垂直移动距离\r\n      // 如果只是缩放scale，只关注a和d两个数值就好：\r\n      // a是水平缩放倍数，d是垂直缩放倍数\r\n      // 如果是旋转rotate，假设旋转角度是θ：\r\n      // matrix(cosθ,sinθ,-sinθ,cosθ,0,0)\r\n      // 拉伸skew，用到了三角函数tanθ，只与b, c两个参数相关，书写如下：\r\n      // （注意y轴倾斜角度在前）\r\n      // matrix(1,tan(θy),tan(θx),1,0,0)\r\n\r\n      // and forward it it to panzoom.\r\n      var instance = panzoom(document.getElementById(\"cavans\"), {\r\n        zoomDoubleClickSpeed: 1\r\n      });\r\n\r\n      let style = window.getComputedStyle(document.getElementById(\"cavans\"));\r\n\r\n      var values = [];\r\n\r\n      instance.on(\"panend\", (e, dx, dy, dz) => {\r\n        console.log(\"Fired when pan ended\", e, dx, dy, dz);\r\n\r\n        values = style.transform\r\n          .split(\"(\")[1]\r\n          .split(\")\")[0]\r\n          .split(\",\");\r\n\r\n        console.log(values);\r\n\r\n        console.log(\"x\", parseFloat(values[4]));\r\n        console.log(\"y\", parseFloat(values[5]));\r\n\r\n        console.log(\"坐标\", {\r\n          x: parseFloat(values[4]) * parseFloat(values[0]),\r\n          y: parseFloat(values[5]) * parseFloat(values[3])\r\n        });\r\n\r\n        // this.modifyElementPosition({\r\n        //   x: parseFloat(values[4]) * parseFloat(values[0]),\r\n        //   y: parseFloat(values[5]) * parseFloat(values[3])\r\n        // });\r\n      });\r\n\r\n      instance.on(\"zoom\", (e, dx, dy, dz) => {\r\n        console.log(\"Fired when `element` is zoomed\", e, dx, dy, dz);\r\n        values = style.transform\r\n          .split(\"(\")[1]\r\n          .split(\")\")[0]\r\n          .split(\",\");\r\n\r\n        console.log(values);\r\n\r\n        console.log(\"水平缩放\", parseFloat(values[0]));\r\n        console.log(\"垂直缩放\", parseFloat(values[3]));\r\n\r\n        console.log(\"坐标\", {\r\n          x: parseFloat(values[4]) * parseFloat(values[0]),\r\n          y: parseFloat(values[5]) * parseFloat(values[3])\r\n        });\r\n\r\n        // this.modifyElementPosition({\r\n        //   x: parseFloat(values[4]) * parseFloat(values[0]),\r\n        //   y: parseFloat(values[5]) * parseFloat(values[3])\r\n        // });\r\n      });\r\n    },\r\n\r\n    drawJsplumbChart(data, connectCallback) {\r\n      addEndpointToNode(\r\n        data.jsplumbInstance,\r\n        data.self,\r\n        data.flowData,\r\n        val => {\r\n          this.stepData = _.map(this.stepData, item => {\r\n            if (item.id == val.id) {\r\n              return {\r\n                ...item,\r\n                x: val.x,\r\n                y: val.y\r\n              };\r\n            } else {\r\n              return item;\r\n            }\r\n          });\r\n        },\r\n        _\r\n      );\r\n      connect(\r\n        data.jsplumbInstance,\r\n        data.self,\r\n        data.links,\r\n        connectCallback\r\n      );\r\n    },\r\n    completedConnect() {\r\n      this.getLinksData();\r\n    },\r\n    handleDrop(data, event) {\r\n      console.log(\"dropAction(data, event) {\");\r\n      this.$emit(\"handleDrop\", { data: data, event: event });\r\n    },\r\n    delConnections(val, fn) {\r\n      message(\r\n        \"确定删除当前连线\",\r\n        () => {\r\n          fn();\r\n          this.getLinksData();\r\n        },\r\n        this\r\n      );\r\n    },\r\n    delNode(val) {\r\n      message(\r\n        \"确定删除当前节点\",\r\n        () => {\r\n          this.stepData = _.filter(_.cloneDeep(this.stepData), item => {\r\n            return item.id != val;\r\n          });\r\n        },\r\n        this\r\n      );\r\n    },\r\n    dblClick(val) {\r\n      this.$emit(\"nodedblClick\", val);\r\n    },\r\n    getLinksData() {\r\n      this.links = filterLinkData(\r\n        _.map(this.jsplumbInstance.getAllConnections(), item => {\r\n          return {\r\n            name: item.id,\r\n            source: item.sourceId,\r\n            sourceOutput: item.endpoints[0].canvas.nextSibling.textContent,\r\n            target: item.targetId,\r\n            targetInput: item.target.dataset.type,\r\n            input: item.endpoints[1].canvas.nextSibling.textContent\r\n          };\r\n        }),\r\n        _\r\n      );\r\n    },\r\n    reset() {\r\n      this.stepData = [];\r\n      this.links = [];\r\n      this.jsplumbInstance.deleteEveryEndpoint(\"workplace\");\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.jsplumb-chart {\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n  .cavans {\r\n    width: 100%;\r\n    height: 100%;\r\n    position: relative;\r\n    top: 0;\r\n    left: 0;\r\n    //   background-image: url(\"../assets/img/designBg.png\");\r\n\r\n    // ////////////////////////node style begin///////////////////\r\n    .designIconBig {\r\n      height: 70px;\r\n      width: 150px;\r\n      margin: 0 auto;\r\n      padding: 12px;\r\n      box-sizing: border-box;\r\n      box-shadow: 0 10px 18px -9px rgba(0, 0, 0, 0.5);\r\n      background: #ffffff;\r\n      text-align: center;\r\n      position: absolute;\r\n      margin-right: 15px;\r\n      margin-bottom: 20px;\r\n      cursor: pointer;\r\n      float: left;\r\n    }\r\n\r\n    .designIconBig i {\r\n      float: none !important;\r\n      position: absolute;\r\n      left: 5px;\r\n      top: 8px;\r\n      width: 30px !important;\r\n      height: 30px !important;\r\n      line-height: 30px !important;\r\n      font-size: 30px !important;\r\n    }\r\n\r\n    .designIconBig h4 {\r\n      position: absolute;\r\n      top: 5px;\r\n      left: 38px;\r\n      margin: 0px;\r\n      padding: 0px;\r\n      width: 110px;\r\n      text-align: left;\r\n      font-size: 14px;\r\n      font-weight: bold;\r\n      white-space: nowrap;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n\r\n    .designIconBig h5 {\r\n      position: absolute;\r\n      top: 25px;\r\n      left: 38px;\r\n      margin: 0px;\r\n      padding: 0px;\r\n      width: 110px;\r\n      text-align: left;\r\n      font-size: 12px;\r\n      font-weight: normal;\r\n      white-space: nowrap;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n\r\n    .designIconBig #removeDes {\r\n      position: absolute;\r\n      top: 46px;\r\n      right: 15px;\r\n      font-size: 14px;\r\n      color: #b9c0d8;\r\n      margin: 0px;\r\n      padding: 0px;\r\n    }\r\n\r\n    .designIconBig #copeDes {\r\n      position: absolute;\r\n      top: 45px;\r\n      right: 35px;\r\n      font-size: 14px;\r\n      color: #b9c0d8;\r\n      margin: 0px;\r\n      padding: 0px;\r\n    }\r\n    .designIconBig #pitchOnDes {\r\n      position: absolute;\r\n      top: 47px;\r\n      right: 60px;\r\n      font-size: 14px;\r\n      color: #b9c0d8;\r\n      margin: 0px;\r\n      padding: 0px;\r\n    }\r\n    .desingIconBig #markDes {\r\n      position: absolute;\r\n      top: 45px;\r\n      right: 20px;\r\n      font-size: 14px;\r\n      color: #b9c0d8;\r\n      margin: 0px;\r\n      padding: 0px;\r\n    }\r\n\r\n    .t1Style {\r\n      border: 2px solid #48c038;\r\n      color: #48c038;\r\n      border-radius: 2px;\r\n    }\r\n    .t2Style {\r\n      border: 2px solid #4586f3;\r\n      color: #4586f3;\r\n      border-radius: 2px;\r\n    }\r\n    .t3Style {\r\n      border: 2px solid #8367df;\r\n      color: #8367df;\r\n      border-radius: 2px;\r\n    }\r\n\r\n    .redStyle {\r\n      border: 2px solid red;\r\n    }\r\n    .designIconBg {\r\n      position: absolute;\r\n      color: #ffffff !important;\r\n    }\r\n\r\n    .designIconBig #removeDes:hover {\r\n      color: #ff4e4e;\r\n    }\r\n\r\n    .designIconBig #copeDes:hover {\r\n      color: #ff4e4e;\r\n    }\r\n\r\n    .designIconBig #pitchOnDes:hover {\r\n      color: #ff4e4e;\r\n    }\r\n\r\n    // ////////////////////////node style end///////////////////\r\n  }\r\n}\r\n</style>\r\n"]}]}